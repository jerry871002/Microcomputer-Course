	ORG 0000H
	AJMP MAIN
	ORG 0050H
MAIN:
	MOV DPTR, #NUMTABLE

	MOV A, P2
	ANL A, #40H		;取出bit6
	JNZ RESULT

	MOV A, P2
	ANL A, #20H		;取出bit5
	JZ NOTINPUT
	AJMP INPUT
NOTINPUT:
	AJMP SETNUM
FINISHIN:
	AJMP MAIN

INPUT:
	MOV A, P2
	ANL A, #20H		;取出bit5
	JZ FINISHIN		;模式改變後跳出

	MOV A, P2
	ANL A, #40H		;取出bit6
	JNZ RESULT

	MOV A, P2
	ANL A, #10H		;取出bit4
	JNZ INPUTSECOND
	MOV A, P2
	ANL A, #0FH		;取前3bit
	MOV 21H, A
	ACALL SHOWNUM
	AJMP INPUT
INPUTSECOND:
	MOV A, P2
	ANL A, #0FH		;取前3bit
	MOV 20H, A
	ACALL SHOWNUM
	AJMP INPUT

SETNUM:
	MOV A, P2
	ANL A, #20H		;取出bit5
	JNZ FINISHIN	;模式改變後跳出

	MOV A, P2
	ANL A, #40H		;取出bit6
	JNZ RESULT

	MOV A, P2
	ANL A, #10H		;取出bit4
	JNZ SETSECOND
	MOV A, P2
	ANL A, #0FH		;取前3bit
	MOV 23H, A
	ACALL SHOWNUM
	AJMP SETNUM
SETSECOND:
	MOV A, P2
	ANL A, #0FH		;取前3bit
	MOV 22H, A
	ACALL SHOWNUM
	AJMP SETNUM

RESULT:
	MOV A, P2
	ANL A, #40H		;取出bit6
	JZ MAIN			;模式改變後退出

	ACALL SHOWBLACK

	MOV A, 23H
	CJNE A, 21H, RESULT ;答案跳回
	MOV A, 22H
	CJNE A, 20H, RESULT ;答案跳回

	AJMP SHOWRIGHT

SHOWBLACK:
	MOV P1, #07FH
	RET

SHOWRIGHT:
	MOV A, #7FH
SHOWRIGHTLOOP:	
	MOV P1, A
	ACALL DELAY
	RR A
	CJNE A, #7FH, SHOWRIGHTLOOP
	AJMP MAIN

SHOWNUM:
	MOVC A, @A+DPTR
	MOV P1, A
	RET

NUMTABLE:
	DB 0C0H ;0
	DB 0F9H ;1
	DB 0A4H ;2
	DB 0B0H ;3
	DB 099H ;4
	DB 092H ;5
	DB 082H ;6
	DB 0F8H ;7
	DB 080H ;8
	DB 090H ;9
	DB 088H ;A
	DB 083H ;B
	DB 0C6H ;C
	DB 0A1H ;D
	DB 086H ;E
	DB 08EH ;F

DELAY:
	MOV R5, #0FFH
DELAY1:
	MOV R6, #0FFH
DELAY2:
	MOV R7, #30H
DELAY3:
	DJNZ R7, DELAY3
	DJNZ R6, DELAY2
	DJNZ R5, DELAY1
	RET
